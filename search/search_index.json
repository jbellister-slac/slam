{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"SLAC Alarm Manager","text":"<p>The SLAC Alarm Manager contains two main ways of interfacing with the NALMS alarm system. There is a standalone python application for viewing and interacting with alarms descibed in greater detail here. And a PyDM data plugin that will allow for building displays containing summary alarms as described here.</p>"},{"location":"alarm_manager/","title":"Alarm Manager","text":"<p>Since the alarm server and logger are both built with Phoebus, many of the interface details and actions described here will be familiar to anyone who has used the Phoebus alarm interface in the past.</p>"},{"location":"developer/","title":"Developer Information","text":"<p>This section includes some additional information that will be useful to anyone who wishes to build their own interface to NALMS in a similar fashion to either the alarm manager or the PyDM data plugin.</p>"},{"location":"pydm/","title":"PyDM Support","text":"<p>PyDM is a python based framework for building interfaces for control systems described in more detail here. PyDM is able to read in data from multiple sources via data plugins, allowing a standard way for UI widgets to receive and display data.</p> <p>One such data plugin is included with the slac-alarm-manager package. An associated entrypoint will cause PyDM to automatically discover this data plugin and allow the user to build displays that include data from the alarm system.</p>"},{"location":"pydm/#what-are-summary-alarms","title":"What Are Summary Alarms?","text":"<p>Since PyDM already includes built-in support for fetching and displaying the alarm status of individual PVs, the  main benefit of this new plugin is for the display of summary alarms. A summary alarm is one which comprises a number of underlying PVs or (other summary alarms). As an example, let's take an alarm hierarchy that looks like this:</p> <p></p> <p>Where the associated xml file describing the structure could look as follows:</p> <pre><code>&lt;?xml version='1.0' encoding='utf8'?&gt;\n&lt;config name=\"Demo\"&gt;\n    &lt;component name=\"GROUP1\"&gt;\n        &lt;pv name=\"DEMO:PV1\"&gt;\n            &lt;enabled&gt;true&lt;/enabled&gt;\n        &lt;/pv&gt;\n        &lt;pv name=\"DEMO:PV2\"&gt;\n            &lt;enabled&gt;true&lt;/enabled&gt;\n        &lt;/pv&gt;\n        &lt;pv name=\"DEMO:PV3\"&gt;\n            &lt;enabled&gt;true&lt;/enabled&gt;\n        &lt;/pv&gt;\n    &lt;/component&gt;\n    &lt;component name=\"GROUP2\"&gt;\n        &lt;component name=\"GROUP3\"&gt;\n            &lt;pv name=\"DEMO:PV4\"&gt;\n                &lt;enabled&gt;true&lt;/enabled&gt;\n            &lt;/pv&gt;\n            &lt;pv name=\"DEMO:PV5\"&gt;\n                &lt;enabled&gt;true&lt;/enabled&gt;\n            &lt;/pv&gt;\n        &lt;/component&gt;\n        &lt;pv name=\"DEMO:PV6\"&gt;\n            &lt;enabled&gt;true&lt;/enabled&gt;\n        &lt;/pv&gt;\n        &lt;pv name=\"DEMO:PV7\"&gt;\n            &lt;enabled&gt;true&lt;/enabled&gt;\n        &lt;/pv&gt;\n    &lt;/component&gt;\n&lt;/config&gt;\n</code></pre> <p>Here <code>GROUP1</code> is a top level summary that will reflect the highest severity alarm from <code>DEMO:PV1</code>, <code>DEMO:PV2</code>, and <code>DEMO:PV3</code>. <code>GROUP2</code> will do the same for its underlying components, one of which (<code>GROUP3</code>) is a summary alarm itself. So if say <code>DEMO:PV2</code> goes into a minor alarm state, and <code>DEMO:PV3</code> into a major, then <code>GROUP1</code> will go into a major alarm state as well. If <code>DEMO:PV3</code> returns to normal, then <code>GROUP1</code> will go into a minor alarm state as <code>DEMO:PV2</code> now has the highest severity among its components.</p> <p>We will create an example display based on this alarm hierarchy to show this and the PyDM/NALMS integration in action.</p>"},{"location":"pydm/#creating-a-sample-display","title":"Creating a Sample Display","text":"<p>To keep this display simple, we will just drop some PyDMFrame widgets onto it along with associated labels identifying each summary alarm or PV being represented:</p> <p></p> <p>Next we'll connect each to a channel. The new <code>nalms://</code> protocol has been added as a way to communicate with the alarm system. Using this protocol is required for the summary alarms as there is no actual IOC backing any of them. But as  shown in this demo, using either regular channel access or <code>nalms://</code> is fine when dealing with individual PVs:</p> <p></p>"},{"location":"pydm/#running-the-display","title":"Running the Display","text":"<p>To see the display working, first ensure that the following two environment variables are set to the correct value of the alarm topic to monitor, as well as the location of the kafka cluster. For this demo:</p> <pre><code>export PYDM_KAFKA_ALARM_TOPIC=Demo\nexport PYDM_KAFKA_BOOTSTRAP_SERVERS=localhost:9092\n</code></pre> <p>Now with an instance of this display running, we can issue caput commands in order to toggle the PVs into various alarm states. Here a minor alarm is represented by the darkened single border around a frame, and a major by the red double border. You can see that the summary alarms will automatically take on the highest alarm state of any of its underlying PVs as described above:</p> <p></p> <p>As a final note, the <code>nalms://</code> protocol should work with any widget which supports displaying alarm status, so more complex displays than this can be created, for example with related display buttons to drill down into the components of a system. And it is also possible to have the same PV as part of multiple summary alarms if needed.</p>"}]}